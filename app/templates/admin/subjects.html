{% extends 'base.html' %}
{% block title %}Админка: Предметы{% endblock %}
{% block content %}
<div class="container-fluid admin-subjects">
  <!-- Заголовок -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">Управление предметами</h2>
    <span class="badge bg-primary fs-6">{{ subjects|length }} предметов</span>
  </div>

  <div class="row g-4">
    <!-- Создание предмета -->
    <div class="col-lg-4">
      <div class="card shadow-sm border-0" style="background: #1a1a1a; height: fit-content;">
        <div class="card-body">
          <h5 class="card-title mb-3">
            <i class="fas fa-plus me-2 text-primary"></i>Создать предмет
          </h5>
          <form method="post">
            {{ form.hidden_tag() }}
            <div class="mb-3">
              <label for="{{ form.title.id }}" class="form-label">Название предмета</label>
              {{ form.title(class_='form-control', placeholder='Введите название предмета', style='background: #0e0e0f; border: 1px solid #3a3a3a; color: #ffffff; border-radius: 20px;') }}
              {% if form.title.errors %}
                <div class="text-danger small">
                  {% for error in form.title.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
            </div>
            <div class="mb-3">
              <label for="{{ form.description.id }}" class="form-label">Описание</label>
              {{ form.description(class_='form-control', placeholder='Введите описание предмета', style='background: #0e0e0f; border: 1px solid #3a3a3a; color: #ffffff; border-radius: 20px; min-height: 80px; resize: vertical;') }}
              {% if form.description.errors %}
                <div class="text-danger small">
                  {% for error in form.description.errors %}
                    {{ error }}
                  {% endfor %}
                </div>
              {% endif %}
            </div>
            <button type="submit" class="btn btn-primary text-white w-100" style="color: #fff !important; border-radius: 20px;">
              <i class="fas fa-plus me-2"></i>Создать предмет
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- Список предметов -->
    <div class="col-lg-8">
      <div class="card shadow-sm border-0" style="background: #1a1a1a;">
        <div class="card-body p-0">
          <div class="table-responsive">
            <table class="table table-hover mb-0" style="background: #1a1a1a; color: #ffffff;">
              <thead style="background: #2a2a2a;">
                <tr>
                  <th class="border-0" style="color: #ffffff;">ID</th>
                  <th class="border-0" style="color: #ffffff;">Название</th>
                  <th class="border-0" style="color: #ffffff;">Описание</th>
                  <th class="border-0" style="color: #ffffff;">Материалы</th>
                  <th class="border-0" style="color: #ffffff;">Действия</th>
                </tr>
              </thead>
              <tbody style="background: #1a1a1a;">
                {% for subject in subjects %}
                <tr style="border-color: #3a3a3a; background: #1a1a1a; color: #ffffff;">
                  <td style="color: #ffffff;"><span class="badge bg-secondary">{{ subject.id }}</span></td>
                  <td style="color: #ffffff;">
                    <strong>{{ subject.title }}</strong>
                  </td>
                  <td style="color: #ffffff;">
                    <small class="text-muted">{{ subject.description[:100] }}{% if subject.description|length > 100 %}...{% endif %}</small>
                  </td>
                  <td style="color: #ffffff;">
                    <span class="badge bg-info">{{ subject.materials|length }} материалов</span>
                  </td>
                  <td style="color: #ffffff;">
                    <div class="btn-group btn-group-sm" role="group">
                      <a href="{{ url_for('main.subject_detail', subject_id=subject.id) }}" class="btn btn-outline-primary" title="Просмотр">
                        <i class="fas fa-eye"></i>
                      </a>
                      <form method="post" action="{{ url_for('main.delete_subject', subject_id=subject.id) }}" style="display: inline;" onsubmit="return confirm('Удалить предмет?')">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        <button type="submit" class="btn btn-outline-danger" title="Удалить">
                          <i class="fas fa-trash"></i>
                        </button>
                      </form>
                    </div>
                  </td>
                </tr>
                {% else %}
                <tr style="border-color: #3a3a3a; background: #1a1a1a; color: #ffffff;">
                  <td colspan="5" class="text-center text-muted py-4">
                    <i class="fas fa-inbox fa-2x mb-3"></i>
                    <p class="mb-0">Нет предметов</p>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} 